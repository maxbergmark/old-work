import json
from urllib.request import urlopen, quote
import time
import subprocess
import os

def get_jsonparsed_data(url):
    response = None
    tries = 0
    while not response:
    	try:
    		response = urlopen(url)
    	except:
    		# print('Exception')
    		tries += 1
    		time.sleep(0.2)
    	if (tries > 0 and tries % 10 == 0):
    		print('Failed attempt number %d.' % (tries))
    data = bytes(response.read()).decode('utf-8')
    return json.loads(data)


ips = ["213.89.161.54", "83.185.240.187", "129.16.169.1", "94.234.32.175", "95.199.1.231", "150.70.173.54", "31.13.102.117", "31.13.102.127", "31.13.102.106", "31.13.102.108", "31.13.102.103", "31.13.102.119", "31.13.102.102", "31.13.102.105", "31.13.102.107", "150.70.173.21", "31.13.102.110", "139.162.114.70", "175.144.254.131", "134.196.31.114", "185.69.5.3", "36.37.219.30", "221.219.207.152", "104.148.75.18", "86.98.1.81", "31.13.102.99", "31.13.102.126", "31.13.102.111", "180.97.106.37", "189.224.234.42", "185.110.132.231", "83.233.86.184", "94.234.32.44", "209.0.146.172", "213.185.21.106", "81.234.179.232", "94.234.170.221", "31.13.102.125", "31.13.102.104", "66.102.9.51", "79.138.130.88", "217.21.230.122", "95.199.25.157", "31.13.102.101", "159.20.26.2", "31.13.102.116", "95.199.12.22", "83.252.165.204", "2.67.24.13", "90.230.93.142", "213.89.234.60", "83.254.220.88", "182.92.176.250", "77.218.251.206", "83.209.60.80", "77.218.227.171", "2.67.109.221", "31.211.225.39", "83.248.83.18", "83.254.73.104", "81.82.186.156", "46.11.10.174", "85.194.4.151", "178.16.218.41", "129.16.30.7", "87.96.244.228", "83.233.220.41", "83.252.99.219", "80.216.250.210", "83.227.100.172", "85.227.176.134", "94.234.170.79", "213.112.242.115", "5.150.193.4", "130.229.172.70", "84.216.247.149"]
loc = {}

FNULL = open(os.devnull, 'w')
for ip in ips:
	s = "curl ipinfo.io/" + ip
	proc = subprocess.Popen([s, ""], stdout=subprocess.PIPE, shell=True)
	(out, err) = proc.communicate()
	print(out)
	d = json.loads(out.decode('utf-8'))
	loc[ip] = d


for l in loc.keys():
	print()
	print(l)
	print(loc[l]['org'])
	print(loc[l]['city'])
	print(loc[l]['region'])
	print(loc[l]['country'])
